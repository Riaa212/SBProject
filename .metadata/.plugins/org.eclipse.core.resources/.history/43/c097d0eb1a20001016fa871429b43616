package com.example.admin.service.impl;

import java.time.LocalDateTime;
import java.util.Optional;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.data.domain.Page;
import org.springframework.data.domain.PageRequest;
import org.springframework.stereotype.Service;

import com.example.admin.domain.UserEntity;
import com.example.admin.enums.RoleEnum;
import com.example.admin.proxy.UserProxy;
import com.example.admin.repository.UserRepo;
import com.example.admin.service.UserService;
import com.example.admin.utils.Helper;
import com.github.javafaker.Faker;

@Service
public class UserServiceImpl implements UserService
{
	
	@Autowired	
	private Helper helper;

	@Autowired
	private UserRepo userRepo;
	
	@Override
	public String registerUser( UserProxy user) {
		user.setRole(RoleEnum.User);
		UserEntity userObj = helper.convert(user, UserEntity.class);
		userRepo.save(helper.convert(user, UserEntity.class));
		return "user Register successfully..";
	}

	
	
	//save bluck of users
	public String saveBulkOfUsers(Integer noOfUsers) {

		for(int i=0;i<noOfUsers;i++)
		{
//			studentRepository.save(generateStudent());
			userRepo.save(generateUsers());
		}
		return null;
	}
	
	
	private UserEntity generateUsers()
	{
	LocalDateTime curreDateTime=LocalDateTime.now();
	Faker f=new Faker();
	UserEntity user=new UserEntity();
	user.setUserName(f.name().fullName());
	user.setEmail(f.name().fullName()+"."+"@gmail.com");
   //	user.getGender(f.)
	
	//	student.setFname(f.name().firstName());
//	student.setLname(f.name().lastName());
//	student.setAddress(f.address().fullAddress());
//	student.setAge(f.date().birthday().getYear());
	
	//curreDateTime.minusYears(f.date().birthday().getYear());
	//student.getImg(f.avatar().image().toString());
//	student.setEmail(f.name().firstName()+"."+"@gmail.com");
//	student.setDate(curreDateTime.minusYears(f.date().birthday().getYear()));
	return user;
	}
	@Override
	public Page<UserEntity> getAllusers(Integer pageNumber, Integer pageSize) {
//		List<UserEntity> userEntity = userRepo.findAll();
//		return helper.convertList(userEntity, UserProxy.class);
		Page<UserEntity> page = userRepo.findAll(PageRequest.of(pageNumber, pageSize));
		System.err.println("page===>"+page+"\nPage Number==>"+pageNumber+"\nPage Size==>"+pageSize);
		return page;
	}

	
	@Override
	public UserProxy getUserById(Integer userId) {
		Optional<UserEntity> byId = userRepo.findById(userId);
//		if(byId.isPresent())
//		{
//			
//		}
		return null;
	}

	@Override
	public UserProxy updateUserById(UserProxy user, Integer id) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public String deleteUserById(Integer id) {
		// TODO Auto-generated method stub
		return null;
	}

}
